SELECT * 
FROM EMPLOYEE;

SELECT EMP_NAME, PHONE
FROM EMPLOYEE;

SELECT PHONE, EMP_NAME
FROM EMPLOYEE;

SELECT *
FROM EMPLOYEE
WHERE DEPT_CODE ='D5';

--1. JOB TABLE에서 JOB_NAME 정보만 출력
SELECT JOB_NAME
FROM JOB;

--2. DEPARTMENT TABEL의 모든 정보 출력
SELECT *
FROM DEPARTMENT;

/*
3. EMPLOYEE 테이블에서 이름(EMP_NAME), 이메일(EMAIL), 전화번호(PHONE),
고용일 (HIRE_DATE)만 출력
*/
SELECT EMP_NAME, EMAIL, PHONE, HIRE_DATE
FROM EMPLOYEE;

--4. EMPLOYEE 테이블에서 이름(EMP_NAME), 월급(SALARY)를 출력하는데, 월급이 200만원ㅇ 이상인 사람만 출력              
SELECT EMP_NAME, SALARY
FROM EMPLOYEE
WHERE SALARY>=2000000;

--연봉이라는 칼럼을 만들지 않아도 칼럼을 생성해 출력이 가능하다.
SELECT EMP_NAME, SALARY, SALARY*12 
FROM EMPLOYEE;
--보너스까지 포함한 연봉
SELECT EMP_NAME, SALARY, (SALARY+(SALARY*BONUS))*12
FROM EMPLOYEE;

--이름넣기. AS는 띄어쓰기로 대체 가능, 특수문자가 들어간 경우엔 ""사용 
SELECT EMP_NAME AS 이름, SALARY  급여, (SALARY+(SALARY*BONUS))*12 AS "연봉(원)"
FROM EMPLOYEE;

--LITERAL
SELECT EMP_NAME, SALARY, '원' AS 단위
FROM EMPLOYEE;

-- SYSDATE : 현재 시간 기준의 날짜 데이터 타입 반환 
--(DUAL이라는 테이블은 만들지 않아도 사용 가능한 테스트 테이블)
SELECT SYSDATE 오늘날짜 FROM DUAL;
SELECT SYSDATE-1 AS 어제날짜 FROM DUAL;
SELECT SYSDATE+1 AS 내일날짜 FROM DUAL;
SELECT SYSDATE+1-SYSDATE AS 하루차이 FROM DUAL;
SELECT (SYSDATE+1)-(SYSDATE-1) AS 이틀차이 FROM DUAL;

--실습문제
--1. EMPLOYEE 테이블에서 이름,연봉, 총수령액(보너스포함), 실수령액(총 수령액-(월급*세금 3%))가 출력되도록 하시오.
SELECT 
    EMP_NAME AS 이름, 
    SALARY*12 AS 연봉, 
    (SALARY+(SALARY*BONUS))*12 AS 총수령액, 
    (SALARY+(SALARY*BONUS)-(SALARY*0.03))*12 AS 실수령액
FROM 
    EMPLOYEE;

--2. EMPLOYEE 테이블에서 이름, 근무 일수를 출력해보시오 (SYSDATE를 사용하면 현재 시간 출력) (FLOOR 소수점 버리기)
SELECT 
    EMP_NAME AS 이름, 
    FLOOR(SYSDATE-HIRE_DATE) AS 근무일수
FROM 
    EMPLOYEE;

--3. EMPLOYEE 테이블에서 20년 이상 근속자의 이름,월급,보너스율를 출력하시오--
SELECT 
    EMP_NAME 이름, 
    SALARY 월급, 
    BONUS 보너스
FROM 
    EMPLOYEE
WHERE  
    (SYSDATE-HIRE_DATE)>=(20*365);

----중복값 제거 DISTINCT
SELECT  DISTINCT  JOB_CODE
FROM  EMPLOYEE;

-- 연결연산자 || 사용
SELECT EMP_ID || EMP_NAME
FROM EMPLOYEE;

SELECT SALARY || '원'
FROM EMPLOYEE;

--논리연산자
SELECT EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE DEPT_CODE='D6' AND SALARY>=3000000;

--BETWEEN AND
SELECT EMP_NAME, SALARY
FROM EMPLOYEE
WHERE SALARY BETWEEN 3500000 AND 6000000;
--WHERE SALARY >= 3500000 AND SALARY <= 6000000;

--성이 전씨인 직원 이름 출력 _ 글자수 만큼 % 몇 글자던 상관 x
SELECT EMP_NAME
FROM EMPLOYEE; --전체출력

SELECT EMP_NAME
FROM EMPLOYEE
WHERE EMP_NAME LIKE '전%'; --전을 포함한 모든 사람
--WHERE EMP_NAME LIKE '전__'; --전을 포함하고 이후 두 글자 아무 것

SELECT EMP_NAME, EMAIL
FROM EMPLOYEE;
--이메일 주소 중 _앞이 세글자인 이메일주소 출력 ESCAPE 사용
SELECT EMP_NAME, EMAIL
FROM EMPLOYEE
WHERE EMAIL LIKE '___#_%' ESCAPE '#';
------> ESCAPE부터는 실제 문자. #이 아니고 다른 거여도 됨

--NOT LIKE
SELECT EMP_NAME
FROM EMPLOYEE
WHERE EMP_NAME NOT LIKE '이%';

--IS NULL / IS NOT NULL
SELECT EMP_NAME, SALARY
FROM EMPLOYEE
WHERE BONUS IS NULL;

--IN / NOT IN 
SELECT EMP_NAME, DEPT_CODE
FROM EMPLOYEE
--WHERE DEPT_CODE = 'D6' OR DEPT_CODE='D9';
WHERE DEPT_CODE IN ('D6', 'D9'); --NOT IN의 경우, 괄호 안을 모두 제외한 것만 출력

--SORT (DEFAULT값이 ASC)
SELECT * 
FROM EMPLOYEE
ORDER BY EMP_NAME ASC;
--ASC 생략 가능

SELECT *
FROM EMPLOYEE
ORDER BY EMP_NAME DESC;

SELECT EMP_NAME, EMAIL, DEPT_CODE, SALARY*12 AS 연봉
FROM EMPLOYEE
ORDER BY 1; -- 칼럼의 순서를 입력해도 된다!



SELECT *
FROM EMPLOYEE;
-- 문제1. 
-- 입사일이 5년 이상, 10년 이하인 직원의 이름,주민번호,급여,입사일을 검색하여라
SELECT
    EMP_NAME, EMP_NO, SALARY, HIRE_DATE
FROM
    EMPLOYEE
WHERE
    (SYSDATE-HIRE_DATE) BETWEEN 5*365 AND 10*365;

-- 문제2.
-- 재직중이 아닌 직원의 이름,부서코드를 검색하여라 (퇴사 여부 : ENT_YN)

SELECT
    EMP_NAME, DEPT_CODE, ENT_YN
FROM
    EMPLOYEE
WHERE
    ENT_YN LIKE 'N';

-- 문제3.
-- 근속년수가 10년 이상인 직원들을 검색하여
-- 출력 결과는 이름,급여,근속년수를 근속년수가 오름차순으로 정렬하여 출력하여라
-- 단, 급여는 50% 인상된 급여로 출력되도록 하여라.

SELECT 
    EMP_NAME 이름, 
    SALARY*1.5 AS 급여, 
    FLOOR(SYSDATE-HIRE_DATE) AS 근속년수
FROM
    EMPLOYEE
ORDER BY
    근속년수 ASC;

-- 문제4.
-- 입사일이 99/01/01 ~ 10/01/01 인 사람 중에서 급여가 2000000 원 이하인 사람의
-- 이름,주민번호,이메일,폰번호,급여를 검색 하시오

SELECT
    EMP_NAME, EMP_NO, PHONE, SALARY
FROM
    EMPLOYEE
WHERE
    (HIRE_DATE BETWEEN '99/01/01' AND '10/01/01') AND SALARY <= 2000000;

-- 문제5.
-- 급여가 2000000원 ~ 3000000원 인 여직원 중에서 4월 생일자를 검색하여 
-- 이름,주민번호,급여,부서코드를 주민번호 순으로(내림차순) 출력하여라

SELECT
    EMP_NAME, EMP_NO, SALARY, DEPT_CODE
FROM
    EMPLOYEE
WHERE
    SALARY BETWEEN 2000000 AND 3000000 AND EMP_NO LIKE '___4___2%'
ORDER BY
    EMP_NO DESC;


-- 문제6.
-- 남자 사원 중 보너스가 없는 사원의 오늘까지 근무일을 측정하여 
-- 1000일 마다(소수점 제외) 
-- 급여의 10% 보너스를 계산하여 이름,특별 보너스 (계산 금액) 결과를 출력하여라.
-- 단, 이름 순으로 오름 차순 정렬하여 출력하여라.
SELECT
    EMP_NAME 이름,
    SALARY+(SALARY*0.1*FLOOR((SYSDATE-HIRE_DATE)/1000)) AS 특별보너스
FROM 
    EMPLOYEE
WHERE
    BONUS IS NULL AND EMP_NO LIKE '_______1%'
ORDER BY
    EMP_NAME;




