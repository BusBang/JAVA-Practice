/*
우리회사는 초일류 보험회사이며, 보험판매 시스템을 만들고자 한다. 
판매 상품은 자동차보험, 운전자보험 등 다양한 상품을 판매한다.  

상품은 상품코드, 상품명을 관리한다. 또한 우리회사는 많은 고객을 관리하고 있다. 
고객은 고객번호, 고객명, 연락처를 관리한다.  
고객은 다양한 상품을 가입할 수 있으며, 계약일자, 보험시작일자, 보험종료일자, 
매월 납입보험료, 총납입회차를 관리한다.  보험계약 시 계약자와 피보험자는 동일하다. 
보험계약시 계약 번호는 자동으로 채번된다.

--보험회사테이블설계
--INSURANCE COMPANY ERD

상품	PRODUCT
-상품코드	P_CODE	CHAR(5) PRIMARY KEY
-상품명		P_NAME	VARCHAR2(50)	NOT NULL

고객	CUSTOMER
-고객번호	C_CODE	CHAR(5)	PRIMARY EKY
-고객명		C_NAME	VARCHAR2(15) NOT NULL
-연락처		C_PHONE	CHAR(13)	NOT NULL DEFAULT '010-0000-0000'

계약
-계약번호	C_NUM	NUMBER	PRIMARY
-상품코드	P_CODE	CHAR(5) REFERENCES PRODUCT(P_CODE)
-고객번호	C_CODE	CHAR(5) REFERENCES CUSTOMER(C_CODE)
-계약일자	CONTRACT_DATE	DATE	DEFAULT SYSDATE
-보험시작일자	INS_START	DATE	NOT NULL
-보험종료일자	INS_END		DATE	NOT NULL
-매월 납입보험료	PAYMENT	NUMBER	NOT NULL
-총납입회차	PAYMENT_COUNT	NUMBER	NOT NULL
*/
-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.

-- PRODUCT Table Create SQL
CREATE TABLE PRODUCT
(
    P_CODE    CHAR(5)         NOT NULL, 
    P_NAME    VARCHAR2(50)    NOT NULL, 
    CONSTRAINT PRODUCT_PK PRIMARY KEY (P_CODE)
)
/

COMMENT ON TABLE PRODUCT IS '상품'
/

COMMENT ON COLUMN PRODUCT.P_CODE IS '상품코드'
/

COMMENT ON COLUMN PRODUCT.P_NAME IS '상품명'
/


-- PRODUCT Table Create SQL
CREATE TABLE CUSTOMER
(
    C_CODE     CHAR(5)         NOT NULL, 
    C_NAM      VARCHAR2(15)    NOT NULL, 
    C_PHONE    CHAR(13)        NOT NULL, 
    CONSTRAINT CUSTOMER_PK PRIMARY KEY (C_CODE)
)
/

COMMENT ON TABLE CUSTOMER IS '고객'
/

COMMENT ON COLUMN CUSTOMER.C_CODE IS '고객번호'
/

COMMENT ON COLUMN CUSTOMER.C_NAM IS '고객명'
/

COMMENT ON COLUMN CUSTOMER.C_PHONE IS '연락처'
/


-- PRODUCT Table Create SQL
CREATE TABLE CONTRACT
(
    C_NUM            INT        NOT NULL, 
    P_CODE           CHAR(5)    NULL, 
    C_CODE           CHAR(5)    NULL, 
    CONTRACT_DATE    DATE       NOT NULL, 
    INS_START        DATE       NOT NULL, 
    INS_END          DATE       NOT NULL, 
    PAYMENT          NUMBER     NOT NULL, 
    PAYMENT_COUNT    NUMBER     NOT NULL, 
    CONSTRAINT CONTRACT_PK PRIMARY KEY (C_NUM)
)
/

CREATE SEQUENCE CONTRACT_SEQ
START WITH 1
INCREMENT BY 1;
/


ALTER TABLE CONTRACT
    ADD CONSTRAINT FK_CONTRACT_C_CODE_CUSTOMER_C_ FOREIGN KEY (C_CODE)
        REFERENCES CUSTOMER (C_CODE)
/

ALTER TABLE CONTRACT
    ADD CONSTRAINT FK_CONTRACT_P_CODE_PRODUCT_P_C FOREIGN KEY (P_CODE)
        REFERENCES PRODUCT (P_CODE)
/




